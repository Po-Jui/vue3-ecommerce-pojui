"use strict";(self["webpackChunkvue3_ecommerce_pojui"]=self["webpackChunkvue3_ecommerce_pojui"]||[]).push([[143],{8285:function(t,e,i){i.d(e,{A:function(){return b}});var s=i(641),a=i(9322),l=i(2644);const o={"aria-label":"Page navigation example"},r={class:"pagination justify-content-center"},c={class:"page-item"},n=(0,s.Lk)("span",{"aria-hidden":"true"},"«",-1),u=[n],d=["onClick"],p={class:"page-item"},h=(0,s.Lk)("span",{"aria-hidden":"true"},"»",-1),g=[h];function f(t,e,i,n,h,f){return(0,s.uX)(),(0,s.CE)("nav",o,[(0,s.Lk)("ul",r,[(0,s.Lk)("li",c,[(0,s.Lk)("a",{class:"page-link",href:"#",onClick:e[0]||(e[0]=(0,a.D$)((t=>f.updatePage(i.pages.current_page-1)),["prevent"])),"aria-label":"Previous"},u)]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.pages.total_pages,(t=>((0,s.uX)(),(0,s.CE)("li",{class:(0,l.C4)(["page-item",{active:t===i.pages.current_page}]),key:t},[(0,s.Lk)("a",{class:"page-link",href:"#",onClick:(0,a.D$)((e=>f.updatePage(t)),["prevent"])},(0,l.v_)(t),9,d)],2)))),128)),(0,s.Lk)("li",p,[(0,s.Lk)("a",{class:"page-link",href:"#",onClick:e[1]||(e[1]=(0,a.D$)((t=>f.updatePage(i.pages.current_page+1)),["prevent"])),"aria-label":"Next"},g)])])])}var k={props:["pages"],methods:{updatePage(t){this.$emit("emit-pages",t)}}},m=i(6262);const v=(0,m.A)(k,[["render",f]]);var b=v},8644:function(t,e,i){i.r(e),i.d(e,{default:function(){return tt}});var s=i(641),a=i(2644),l=i(9322),o=i(1888),r=i(5111),c=i(3644),n=i(2649),u=i(7512);const d={class:"products-banner"},p={key:0,class:"text-center"},h={key:1,class:"text-center"},g={class:"container"},f=(0,s.Lk)("i",{class:"loading-box"},null,-1),k={class:"row rwd-product-box"},m={class:"col-md-3 pr-md-0"},v={class:"list-group sticky-top"},b={class:"dropdown"},C=["onClick"],y={class:"col-md-9 position-relative"},L={class:"sortData-box-product"},w=(0,s.Lk)("option",{value:"",disabled:""},"商品排序",-1),x=(0,s.Lk)("option",{value:"highToLow"},"價格由高至低",-1),T=(0,s.Lk)("option",{value:"lowToHigh"},"價格由低至高",-1),I=[w,x,T],_=(0,s.Lk)("span",{class:"icon"},[(0,s.Lk)("i",{class:"fas fa-sort"})],-1),D={class:"d-flex flex-wrap m-card-ground"},F=["onClick"],A=(0,s.Lk)("i",{class:"far fa-bookmark"},null,-1),X=[A],E=["onClick"],P=(0,s.Lk)("i",{class:"fas fa-bookmark"},null,-1),U=[P],H={class:"position-relative"},V={class:"text-center card-title font-weight-bold"},j={class:"d-flex flex-column position-relative"},K={class:"text-center price-box"},O={key:0,class:"origin-price-f mr-2"},W={class:"price-color"},J=["disabled","onClick"],N=(0,s.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1),S=["onClick"];function Z(t,e,i,w,x,T){const $=(0,s.g2)("loading"),A=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("div",d,[""===x.filterType?((0,s.uX)(),(0,s.CE)("h2",p,"全部商品")):((0,s.uX)(),(0,s.CE)("h2",h,(0,a.v_)(x.filterType),1))]),(0,s.Lk)("div",g,[(0,s.bF)($,{active:x.isLoading},{default:(0,s.k6)((()=>[f])),_:1},8,["active"]),(0,s.Lk)("div",k,[(0,s.Lk)("nav",m,[(0,s.Lk)("ul",v,[(0,s.Lk)("div",b,[(0,s.bF)(u.d4,{class:"select",modelValue:x.filterType,"onUpdate:modelValue":e[0]||(e[0]=t=>x.filterType=t),label:"商品分類",items:x.category},{default:(0,s.k6)((()=>[(0,s.bF)(n.q,null,{default:(0,s.k6)((()=>[(0,s.bF)(o.x8,null,{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(x.category,(t=>((0,s.uX)(),(0,s.Wv)(r.g,{key:t},{default:(0,s.k6)((()=>[(0,s.bF)(c.U,{onClick:(0,l.D$)((e=>x.filterType=t),["prevent"])},{default:(0,s.k6)((()=>[(0,s.eW)((0,a.v_)(t),1)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1},8,["modelValue","items"])]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(x.category,(t=>((0,s.uX)(),(0,s.CE)("li",{class:"list-group-item p-xy-0 des-list-group",key:t},[(0,s.Lk)("a",{"data-toggle":"tab",href:"#",class:(0,a.C4)(["list-btn",{active:t===x.filterType}]),onClick:(0,l.D$)((e=>x.filterType=t),["prevent"])},(0,a.v_)(t),11,C)])))),128))])]),(0,s.Lk)("div",y,[(0,s.Lk)("div",L,[(0,s.Lk)("span",null,(0,a.v_)(T.getFilter.length)+" 個商品",1),(0,s.bo)((0,s.Lk)("select",{name:"sortData",id:"sortData","onUpdate:modelValue":e[1]||(e[1]=t=>x.sortData=t),class:"form-control sortData-product mb-3",onChange:e[2]||(e[2]=t=>T.sortProducts())},I,544),[[l.u1,x.sortData]]),_]),(0,s.Lk)("div",D,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(T.getFilter,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"card-flex shadow-sm",key:e.id},[(0,s.Lk)("div",{class:"item-img",style:(0,a.Tr)({backgroundImage:`url(${e.imageUrl})`})},[(0,s.bF)(A,{to:`/product/${e.id}`,class:"btn card-btn-box btn-sm"},{default:(0,s.k6)((()=>[(0,s.eW)(" 查看更多 ")])),_:2},1032,["to"]),-1===x.followData.indexOf(e.id)?((0,s.uX)(),(0,s.CE)("div",{key:0,title:"收藏",class:"icon-tags",onClick:(0,l.D$)((t=>T.addFollow(e.id)),["prevent"])},X,8,F)):((0,s.uX)(),(0,s.CE)("div",{key:1,title:"收藏",class:"icon-tags",onClick:(0,l.D$)((t=>T.addFollow(e.id)),["prevent"])},U,8,E))],4),(0,s.Lk)("div",H,[(0,s.Lk)("h5",V,(0,a.v_)(e.title),1)]),(0,s.Lk)("div",j,[(0,s.Lk)("div",K,[0!==e.origin_price?((0,s.uX)(),(0,s.CE)("span",O,(0,a.v_)(t.$filters.currency(e.origin_price)),1)):(0,s.Q3)("",!0),(0,s.Lk)("span",W,(0,a.v_)(t.$filters.currency(e.price)),1)]),x.status.loadingItem===e.id?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"btn btn-shopping btn-sm",type:"button",disabled:x.status.loadingItem===e.id,onClick:t=>T.addToCart(e.id)},[N,(0,s.eW)(" 加到購物車 ")],8,J)):((0,s.uX)(),(0,s.CE)("button",{key:1,class:"btn btn-shopping btn-sm",type:"button",onClick:t=>T.addToCart(e.id)}," 加到購物車 ",8,S))])])))),128))])])])])])}var q=i(2541),Q=i(8285),z=i(6723),B=i(1601),G=i(1884),M={data(){return{isLoading:!1,status:{loadingItem:""},category:["全部商品","香氛蠟燭","擴香","精油","其他"],isActive:!1,filterType:"",products:{},sortData:"",followData:[],pagination:{},carts:{},userCartItems:[],uid:null}},components:{Pagination:Q.A},created(){this.getAuthState(),this.getProducts(),this.category.length>0&&(this.filterType=this.category[0])},methods:{getAuthState(){(0,B.hg)(z.j2,(t=>{t&&t.emailVerified&&(this.uid=t.uid,this.updateUserCartItem())}))},async updateUserCartItem(t){const e=(0,G.rJ)(z.db,"userInfo"),i=(0,G.H9)(e,this.uid),s=await(0,G.x7)(i);if(s.exists()){if(this.userCartItems=s.data().cartItem,void 0!==t){const e=this.userCartItems.findIndex((e=>e.product.id===t.product.id));-1!==e&&this.userCartItems.splice(e,1),this.userCartItems.push(t),await(0,G.mZ)(i,{cartItem:this.userCartItems})}}else console.log("No such document!")},getProducts(){const t="https://vue3-course-api.hexschool.io/api/luxefume-api/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{this.products=t.data.products,null!==this.uid&&this.getFollow();const{categoryName:e}=this.$route.params;e&&(this.filterType=e),this.isLoading=!1})).catch((()=>{q.A.fire({title:"資料讀取失敗，請稍後再試",icon:"error"}),this.isLoading=!1}))},async getFollow(){const t=(0,G.rJ)(z.db,"userInfo"),e=(0,G.H9)(t,this.uid),i=await(0,G.x7)(e);i.exists()&&(this.followData=i.data().favorite)},scrollTitle(){""===this.filterType||"熱門商品"===this.filterType?this.isActive=!1:this.isActive=!0,$("html,body").animate({scrollTop:0},0)},sortProducts(){this.products.sort(((t,e)=>"lowToHigh"===this.sortData?t.price-e.price:"highToLow"===this.sortData?e.price-t.price:this.products))},addToCart(t){if(null!==this.uid){this.status.loadingItem=t;const e="https://vue3-course-api.hexschool.io/api/luxefume-api/cart",i={product_id:t,qty:1};this.$http.post(e,{data:i}).then((t=>{this.updateUserCartItem(t.data.data),setTimeout((()=>{this.status.loadingItem="",this.$emitter.emit("update-total"),q.A.fire({title:"已加入購物車",icon:"success"})}),500)})).catch((t=>{this.status.loadingItem="",q.A.fire({title:`${t.response.data.errors}`,icon:"warning"})}))}else q.A.fire({title:"請先登入會員",icon:"warning"}),this.$router.push("/userlogin")},async addFollow(t){if(null!==this.uid){const e=this.followData.indexOf(t),i=(0,G.rJ)(z.db,"userInfo"),s=(0,G.H9)(i,this.uid);-1===e?(this.followData.push(t),await(0,G.mZ)(s,{favorite:this.followData}),q.A.fire({title:"已加入收藏",icon:"success"})):(this.followData.splice(e,1),await(0,G.mZ)(s,{favorite:this.followData}),q.A.fire({title:"已取消收藏",icon:"success"}))}else q.A.fire({title:"請先登入會員",icon:"warning"}),this.$router.push("/userlogin")}},computed:{getFilter(){let t=[];switch(this.filterType){case"香氛蠟燭":t=this.products.filter((t=>"Fragrance"==t.category)),this.scrollTitle();break;case"擴香":t=this.products.filter((t=>"AromaStickDiffuser"==t.category)),this.scrollTitle();break;case"精油":t=this.products.filter((t=>"FragranceOil"===t.category)),this.scrollTitle();break;case"其他":t=this.products.filter((t=>"Other"===t.category)),this.scrollTitle();break;default:t=this.products,this.scrollTitle();break}return t}}},R=i(6262);const Y=(0,R.A)(M,[["render",Z]]);var tt=Y}}]);
//# sourceMappingURL=143.9ecd1a16.js.map
"use strict";(self["webpackChunkvue3_ecommerce_pojui"]=self["webpackChunkvue3_ecommerce_pojui"]||[]).push([[176],{5176:function(t,a,s){s.r(a),s.d(a,{default:function(){return pt}});var e=s(641),i=s(2644),l=s(9322);const o=(0,e.Lk)("i",{class:"loading-box"},null,-1),c=(0,e.Lk)("div",{class:"cart-banner"},[(0,e.Lk)("h2",{class:"text-center"},"購物車")],-1),r={class:"container my-5 m-cart-box"},n={class:"row align-items-center"},d={key:0},u={class:"mt-3"},p=(0,e.Lk)("thead",{class:"font-weight-bold"},[(0,e.Lk)("tr",null,[(0,e.Lk)("th"),(0,e.Lk)("th",{class:"text-left"},"商品"),(0,e.Lk)("th",{class:"text-center"},"數量"),(0,e.Lk)("th",null,"單位"),(0,e.Lk)("th",{class:"text-right"},"單價")])],-1),h={class:"border-y"},m=["onClick"],f=(0,e.Lk)("i",{class:"far fa-trash-alt"},null,-1),k=[f],g={class:"produce-num-td"},b={class:"produce-num-group d-flex"},L={class:"num-btnbox"},v=["onClick"],x=(0,e.Lk)("i",{class:"fas fa-minus"},null,-1),y=[x],C=["value","onKeyup"],w={class:"num-btnbox"},T=["onClick"],A=(0,e.Lk)("i",{class:"fas fa-plus"},null,-1),I=[A],_=(0,e.Lk)("span",null,"/",-1),D={class:"text-right"},$={colspan:"4"},q=(0,e.Lk)("i",{class:"far fa-trash-alt"},null,-1),E=(0,e.Lk)("span",{class:"pl-2"},"刪除所有商品",-1),X=[q,E],j={key:1,class:"mb-3 no-shop-box"},H=(0,e.Lk)("p",{class:"py-5 mt-3"},"哎呀！您的購物車是空的，趕快去挑選美品吧！",-1),M=(0,e.Lk)("i",{class:"fas fa-reply mr-2"},null,-1),U={class:"card-body"},W=(0,e.Lk)("h3",null,"訂單價格",-1),B={class:"px-4 mt-3"},G={class:"d-flex justify-content-between"},F=(0,e.Lk)("span",null,"小計：",-1),V={key:0,class:"d-flex fare justify-content-between"},z=(0,e.Lk)("span",null,"運費：",-1),K={key:0},N={key:1},Q=(0,e.Lk)("hr",{class:"m-0 my-2"},null,-1),Y={key:1,class:"text-right promotion"},S={key:2,class:"text-right free"},J={class:"d-flex justify-content-between"},R=(0,e.Lk)("span",null,"總計：",-1),Z=(0,e.Lk)("hr",{class:"hr-opa"},null,-1),O={class:"mt-3 mb-2 check-box"},P=(0,e.Lk)("i",{class:"fas fa-reply mr-2"},null,-1),tt={class:"float-right"},at={key:0,class:"bg-cart-footer"},st=(0,e.Fv)('<div class="container pt-4"><h4 class="font-weight-bold text-center h4">香氛蠟燭冷知識</h4><div class="row mt-4 m-footer-cart"><div class="col-lg-4 col-md-6 mb-4" data-aos="zoom-in"><div class="knowledge-img position-relative" style="background-image:url(https://images.unsplash.com/photo-1489176876421-3b720db0fb3d?q=80&amp;w=2070&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D);"><div class="knowledge-box"><h5 class="font-weight-bolder pt-3 pb-2 pl-4">燃燒溫度</h5><p class="px-4 my-3"> 香氛蠟燭的火焰溫度約為1000°C，因此要小心放置，避免接觸易燃物。 </p></div></div></div><div class="col-lg-4 col-md-6 mb-4" data-aos="zoom-in"><div class="knowledge-img position-relative" style="background-image:url(https://images.unsplash.com/photo-1602523961358-f9f03dd557db?q=80&amp;w=2070&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D);"><div class="knowledge-box"><h5 class="font-weight-bolder pt-3 pb-2 pl-4">熔點差異</h5><p class="px-4 my-3"> 蜂蠟的熔點約為62-64°C，石蠟蠟燭的熔點約為46-68°C，大豆蠟的熔點約為49-55°C。 </p></div></div></div><div class="col-lg-4 col-md-6 mb-4" data-aos="zoom-in"><div class="knowledge-img position-relative" style="background-image:url(https://images.unsplash.com/photo-1495640452828-3df6795cf69b?q=80&amp;w=1887&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D);"><div class="knowledge-box"><h5 class="font-weight-bolder pt-3 pb-2 pl-4">歷史用途</h5><p class="px-4 my-3"> 香氛蠟燭在歷史上常被用於宗教儀式、醫療用途和貴族宴會，以掩蓋不良氣味或創造特定氛圍。 </p></div></div></div></div></div>',1),et=[st];function it(t,a,s,f,x,A){const q=(0,e.g2)("loading"),E=(0,e.g2)("router-link");return(0,e.uX)(),(0,e.CE)("div",null,[(0,e.bF)(q,{active:x.isLoading},{default:(0,e.k6)((()=>[o])),_:1},8,["active"]),c,(0,e.Lk)("div",r,[(0,e.Lk)("div",n,[(0,e.Lk)("div",{class:(0,i.C4)(["col-lg-8 commodity-box",{"col-lg-12":x.fareTotal<=0,"none-commodity":x.fareTotal<=0}])},[x.carts.length>0?((0,e.uX)(),(0,e.CE)("div",d,[(0,e.Lk)("table",u,[p,(0,e.Lk)("tbody",h,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(x.carts,(a=>((0,e.uX)(),(0,e.CE)("tr",{key:a.id+1},[(0,e.Lk)("td",null,[(0,e.Lk)("button",{type:"button",class:"btn btn-outline-danger-trash btn-sm",onClick:t=>A.removeCartItem(a.id)},k,8,m)]),(0,e.Lk)("td",null,(0,i.v_)(a.product.title),1),(0,e.Lk)("td",g,[(0,e.Lk)("div",b,[(0,e.Lk)("div",L,[(0,e.Lk)("button",{class:"btn",onClick:t=>A.quantityUpdata(a.id,a.qty-1)},y,8,v)]),(0,e.Lk)("input",{type:"number",class:"form-control text-center numbox",value:a.qty,onKeyup:(0,l.jR)((t=>A.quantityUpdata(a.id,t.target.value)),["enter"])},null,40,C),(0,e.Lk)("div",w,[(0,e.Lk)("button",{class:"btn",onClick:t=>A.quantityUpdata(a.id,a.qty+1)},I,8,T)])])]),(0,e.Lk)("td",null,[_,(0,e.eW)(" "+(0,i.v_)(a.product.unit),1)]),(0,e.Lk)("td",D,(0,i.v_)(t.$filters.currency(a.product.price)),1)])))),128))]),(0,e.Lk)("tfoot",null,[(0,e.Lk)("tr",null,[(0,e.Lk)("td",$,[(0,e.Lk)("button",{type:"button",class:"btn btn-del-all sideline btn-sm float-left my-3",onClick:a[0]||(a[0]=t=>A.removeAllCartItem())},X)])])])])])):((0,e.uX)(),(0,e.CE)("div",j,[H,(0,e.bF)(E,{to:"/products",class:"text-dark"},{default:(0,e.k6)((()=>[M,(0,e.eW)(" 繼續購買 ")])),_:1})]))],2),(0,e.Lk)("div",{class:(0,i.C4)(["col-lg-4 my-3 card order-price",{"d-none":x.fareTotal<=0}])},[(0,e.Lk)("div",U,[W,(0,e.Lk)("div",B,[(0,e.Lk)("p",G,[F,(0,e.Lk)("span",null,(0,i.v_)(t.$filters.currency(x.cartTotal)),1)]),0!==x.cartTotal?((0,e.uX)(),(0,e.CE)("p",V,[z,x.cartTotal>599?((0,e.uX)(),(0,e.CE)("span",K," NT 0")):((0,e.uX)(),(0,e.CE)("span",N," NT 60"))])):(0,e.Q3)("",!0),Q,x.cartTotal<599||0===x.cartTotal?((0,e.uX)(),(0,e.CE)("p",Y," 優惠促銷：滿 599 免運 ")):((0,e.uX)(),(0,e.CE)("p",S,"已達免運優惠")),(0,e.Lk)("p",J,[R,(0,e.Lk)("span",null,(0,i.v_)(t.$filters.currency(x.fareTotal)),1)]),Z,(0,e.Lk)("div",O,[(0,e.Lk)("div",null,[x.carts.length>0?((0,e.uX)(),(0,e.Wv)(E,{key:0,to:"/products",class:"continue-buy"},{default:(0,e.k6)((()=>[P,(0,e.eW)(" 繼續購買 ")])),_:1})):(0,e.Q3)("",!0)]),(0,e.Lk)("div",tt,[(0,e.bF)(E,{to:"/order",class:(0,i.C4)(["btn btn-shopping checkout",{disabled:x.fareTotal<=0}])},{default:(0,e.k6)((()=>[(0,e.eW)(" 結帳 ")])),_:1},8,["class"])])])])])],2)])]),x.isLoading?(0,e.Q3)("",!0):((0,e.uX)(),(0,e.CE)("section",at,et))])}var lt=s(2541),ot=s(6723),ct=s(1601),rt=s(1884),nt={data(){return{carts:{},cartTotal:0,fareTotal:0,isLoading:!1,products:{},coupon_code:"",userCartItems:[],uid:null}},created(){this.getAuthState(),this.getCart()},watch:{uid(t,a){t?console.log("User is logged in with UID:",t):(console.log("User is logged out or email is not verified"),this.$router.replace("/userlogin"))}},methods:{getAuthState(){(0,ct.hg)(ot.j2,(t=>{t?t.emailVerified?this.uid=t.uid:this.uid=null:(this.uid=null,lt.A.fire({icon:"warning",title:"請先登入會員"}),this.$router.replace("/userlogin"))}))},async updateUserCartItem(t){const a=(0,rt.rJ)(ot.db,"userInfo"),s=(0,rt.H9)(a,this.uid),e=await(0,rt.x7)(s);e.exists()?(this.userCartItems=e.data().cartItem,void 0!==t&&(this.userCartItems=t,await(0,rt.mZ)(s,{cartItem:this.userCartItems}))):console.log("No such document!")},getCart(){const t="https://vue3-course-api.hexschool.io/api/luxefume-api/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.carts=t.data.data.carts,null!==this.uid&&this.updateUserCartItem(this.carts),this.updateTotal(),this.isLoading=!1})).catch((()=>{lt.A.fire({title:"資料讀取失敗，請稍後再試",icon:"error"}),this.isLoading=!1}))},updateTotal(){let t=0;this.carts.forEach((a=>{t+=a.product.price*a.qty})),this.cartTotal=t,this.fareTotal=t>=599||0===t?t:t+60},quantityUpdata(t,a){if(this.isLoading=!0,a=parseInt(a),a>=1){const s=`https://vue3-course-api.hexschool.io/api/luxefume-api/cart/${t}`,e={product_id:t,qty:a};this.$http.put(s,{data:e}).then((t=>{console.log(t),this.getCart(),this.isLoading=!1}))}else lt.A.fire({title:"數量不得小於1",icon:"error"}),this.isLoading=!1},removeCartItem(t){this.isLoading=!0;const a=`https://vue3-course-api.hexschool.io/api/luxefume-api/cart/${t}`;this.$http.delete(a).then((t=>{this.$emitter.emit("update-total"),this.getCart(),this.isLoading=!1,lt.A.fire({title:"商品已刪除",icon:"success"})})).catch((()=>{this.isLoading=!1,lt.A.fire({title:"商品刪除失敗",icon:"error"})}))},removeAllCartItem(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/luxefume-api/carts";this.$http.delete(t).then((()=>{this.$emitter.emit("update-total"),this.getCart(),this.cartTotal=0,this.isLoading=!1,lt.A.fire({title:"商品已全部刪除",icon:"success"})})).catch((()=>{this.isLoading=!1,lt.A.fire({title:"商品刪除失敗",icon:"error"})}))}}},dt=s(6262);const ut=(0,dt.A)(nt,[["render",it]]);var pt=ut}}]);
//# sourceMappingURL=176.9746573b.js.map